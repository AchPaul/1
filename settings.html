<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GrowHub</title>
<link rel="icon" type="image/svg+xml" href="favicon-plant.svg">
<link rel="manifest" href="manifest.json">
<style>
:root{--clr-neon:hsl(288,52%,35%);--clr-bg:hsl(295,14%,67%)}
*{margin:0;padding:0;box-sizing:border-box}
body{background:#000;color:#fff;font-family:'Courier New',monospace}
h2,h3{text-align:center;padding:0 5px}
h3{margin-bottom:20px}
.neon-buttom{background:#000;font-size:16px;text-decoration:none;color:#ebebeb;cursor:pointer;border:var(--clr-neon) .125em solid;padding:.35em 2em;border-radius:.25em;width:210px;text-align:center;box-shadow:inset 0 0 .5em 0 var(--clr-neon),0 0 .5em 0 var(--clr-neon);position:relative}
.neon-buttom:disabled{background:#3d3b3d;color:#fff;cursor:wait}
.neon-buttom::before{content:"";position:absolute;background:var(--clr-neon);top:120%;left:0;width:100%;height:100%;transform:perspective(3em)rotateX(40deg)scale(1,.35);filter:blur(1em);opacity:.7}
.neon-buttom::after{content:"";position:absolute;background:var(--clr-neon);top:0;left:0;bottom:0;right:0;box-shadow:0 0 2em .5em var(--clr-neon);opacity:0;z-index:-1;transition:opacity 100ms}
.neon-buttom:hover,.neon-buttom:focus{color:var(--clr-bg);text-shadow:none}
.neon-buttom:hover::before,.neon-buttom:focus::before,.neon-buttom:hover::after,.neon-buttom:focus::after{opacity:1}
.icon{position:relative}
.icon_btn{position:absolute;top:3px;left:10px}
.main{display:flex;margin:20px 0;justify-content:center;align-items:center;flex-direction:column;gap:25px}
.group_input{color:#fff;width:250px;padding:10px;border:2px solid var(--clr-neon);border-radius:8px;background:0 0;font-size:16px;transition:box-shadow .3s}
.group_input::placeholder{color:#fedbff;opacity:.5}
.group_input:focus{outline:0;box-shadow:0 0 10px var(--clr-neon);background:#812c82;clear:#fff}
.bord{padding:15px;border:2px solid var(--clr-neon);border-radius:12px;background:0 0;font-size:16px;text-align:center;margin-bottom:-15px}
input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:15px;border-radius:5px;background:#d3d3d3;outline:0;opacity:.7;transition:opacity .15s;margin-top:10px}
input[type=range]:hover{opacity:1}
.slider-container{margin-top:0;font-size:18px;color:#fff;margin-bottom:20px}
.slider-title{display:flex;flex-direction:column}
.slider-title div{display:flex;justify-content:space-evenly;margin-bottom:5px}
.slider-value{font-weight:700;transition:all .3s}
.slider{transition:all .3s}
.slider.locked{opacity:.5;pointer-events:none}
.toggle-option{display:flex;align-items:center;gap:10px;justify-content:center;margin-bottom:12px}
.toggle-option input{width:18px;height:18px}
.toggle-option span{font-size:16px}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:30px;height:30px;border-radius:50%;background:#bd65e5;cursor:pointer}
input[type=range]::-moz-range-thumb{width:30px;height:30px;border-radius:50%;background:#4CAF50;cursor:pointer}
header{height:75px;background:linear-gradient(135deg,#500078 0%,#28003c 100%);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 15px rgba(0,0,0,.5);position:relative;z-index:100}
.header-transition{height:40px;background:linear-gradient(#370053, #000);margin-top:-10px;margin-bottom:15px}
.logo{margin-top:2px;display:inline-block}
.grow{font-size:35px;color:#fff;font-weight:700;letter-spacing:5px}
.hub{font-size:35px;color:#c900cc;font-weight:700;letter-spacing:5px;border:7px solid #c900cc;border-radius:13px;padding:2px 2px 2px 8px}
.select-dropdown{position:relative;display:inline-block;max-width:60%;transition:all ease-in-out .3s}
.select-dropdown__button{padding:10px 10px 10px 10px;background:#3f005c;color:#fff;border:3px solid #3f005c;border-radius:15px;text-align:center}
.select-dropdown__button:focus{outline:0}
.neon-divider-1{height:2px;margin:1rem 0;background:linear-gradient(90deg,transparent 10%,var(--clr-neon) 50%,transparent 90%);box-shadow:0 0 8px hsla(288,52%,35%,.4),0 0 16px hsla(288,52%,35%,.2)}
.status-line{font-size:12px;text-align:center;opacity:.85;margin:0 0 10px;color:#e6d8f5}
.status-line.warn{color:#ff9aa0}
</style>
</head>
<body>
<header>
<div class="logo"><span class="grow">Grow</span><span class="hub">Hub</span></div>
</header>
<div class="header-transition"></div>
<div class="status-line" id="status-line">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
<main class="main">
<h2 style="margin-bottom:10px">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–ø–ª–∏—Ü—ã</h2>
<div><h3 class="bord"><span data-field="profile_name">‚Äî</span></h3></div>
<section class="group_input">
<h3 style="margin-top:10px">–î–Ω–µ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span style="margin-bottom:20px">–í—Ä–µ–º—è –æ—Å–≤–µ—â–µ–Ω–∏—è:</span></div></div>
<span class="slider-value" data-live="lig_hours">‚Äî</span> —á–∞—Å–æ–≤ –≤ —Å—É—Ç–∫–∏
<input type="range" class="slider" min="0" max="24" id="inp_lig_hours">
</div>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</span></div></div>
<span class="slider-value" data-live="temp_day">‚Äî</span>¬∞C
<input type="range" class="slider" min="0" max="30" id="inp_temp_day">
</div>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–í–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã:</span></div></div>
<span class="slider-value" data-live="humgr_day">‚Äî</span>%
<input type="range" class="slider" min="0" max="90" id="inp_humgr_day">
</div>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–í–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞:</span></div></div>
<span class="slider-value" data-live="humair_day">‚Äî</span>%
<input type="range" class="slider" min="0" max="90" id="inp_humair_day">
</div>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ (–º–∏–Ω):</span></div></div>
<label class="toggle-option">
<input type="checkbox" id="chk_vent_day_always" data-slider="inp_vent_day">
<span>–í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–æ</span>
</label>
<span class="slider-value" data-live="vent_day">‚Äî</span>
<input type="range" class="slider" min="0" max="180" id="inp_vent_day" data-always-id="chk_vent_day_always">
</div>
<div class="neon-divider-1"></div>
<div style="text-align:center;margin-top:20px">
<button class="neon-buttom icon" id="btn_save_day">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</div>
<div class="neon-divider-1"></div>
</section>
<!--
<section class="group_input">
<h3 style="margin-top:10px">–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ</h3>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–ò–Ω—Ç–µ—Ä–≤–∞–ª (–º–∏–Ω):</span></div></div>
<span class="slider-value" data-live="vent_interval">‚Äî</span>
<input type="range" class="slider" min="0" max="180" id="inp_vent_interval">
</div>
<div style="text-align:center;margin-top:20px">
<button class="neon-buttom icon" id="btn_save_vent">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</div>
<div class="neon-divider-1"></div>
</section>
-->
<section class="group_input">
<h3 style="margin-top:10px">–ù–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</span></div></div>
<span class="slider-value" data-live="temp_night">‚Äî</span>¬∞C
<input type="range" class="slider" min="0" max="30" id="inp_temp_night">
</div>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–í–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã:</span></div></div>
<span class="slider-value" data-live="humgr_night">‚Äî</span>%
<input type="range" class="slider" min="0" max="90" id="inp_humgr_night">
</div>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–í–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞:</span></div></div>
<span class="slider-value" data-live="humair_night">‚Äî</span>%
<input type="range" class="slider" min="0" max="90" id="inp_humair_night">
</div>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ (–º–∏–Ω):</span></div></div>
<label class="toggle-option">
<input type="checkbox" id="chk_vent_night_always" data-slider="inp_vent_night">
<span>–í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–æ</span>
</label>
<span class="slider-value" data-live="vent_night">‚Äî</span>
<input type="range" class="slider" min="0" max="180" id="inp_vent_night" data-always-id="chk_vent_night_always">
</div>
<div class="neon-divider-1"></div>
<div style="text-align:center;margin-top:20px">
<button class="neon-buttom icon" id="btn_save_night">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</div>
<div class="neon-divider-1"></div>
</section>
<section class="group_input" id="dehumidify-section">
<h3 style="margin-top:10px">–û—Å—É—à–µ–Ω–∏–µ</h3>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏:</span></div></div>
<label class="toggle-option">
<input type="checkbox" id="chk_dehumidify">
<span>–í–∫–ª—é—á–∏—Ç—å –æ—Å—É—à–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</span>
</label>
<div style="font-size:13px;color:#fedaff;margin-top:10px;text-align:left">
‚ÑπÔ∏è –ü—Ä–∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤—ã—à–µ —Ü–µ–ª–µ–≤–æ–π+5% –≤–∫–ª—é—á–∏—Ç—Å—è –≤–µ–Ω—Ç–∏–ª—è—Ü–∏—è –¥–ª—è –æ—Å—É—à–µ–Ω–∏—è.<br>
–í–µ–Ω—Ç–∏–ª—è—Ü–∏—è –≤—ã–∫–ª—é—á–∏—Ç—Å—è –∫–æ–≥–¥–∞ –≤–ª–∞–∂–Ω–æ—Å—Ç—å —Å–Ω–∏–∑–∏—Ç—Å—è –¥–æ —Ü–µ–ª—å+2%.
</div>
</div>
<div class="neon-divider-1"></div>
</section>
<section class="group_input" id="alternate-watering-section">
<h3 style="margin-top:10px">–ü–æ–ª–∏–≤ —á–µ—Ä–µ–∑ —Ä–∞–∑</h3>
<div class="neon-divider-1"></div>
<div class="slider-container">
<div class="slider-title"><div><span>–ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ —Ä—É—á–Ω–æ–≥–æ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–ª–∏–≤–∞:</span></div></div>
<label class="toggle-option">
<input type="checkbox" id="chk_alternate_watering">
<span>–í–∫–ª—é—á–∏—Ç—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</span>
</label>
<div style="font-size:13px;color:#fedaff;margin-top:10px;text-align:left">
‚ÑπÔ∏è –†–µ–∂–∏–º —á–µ—Ä–µ–¥—É–µ—Ç —Ä—É—á–Ω–æ–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–ª–∏–≤:<br>
1Ô∏è‚É£ <b>–†—É—á–Ω–æ–π</b> ‚Üí –≤–∞–º –ø—Ä–∏–¥—ë—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–ü–æ–ª–µ–π—Ç–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ"<br>
2Ô∏è‚É£ –ß–µ—Ä–µ–∑ 3 —á–∞—Å–∞ ‚Üí <b>–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π</b> –ø–æ–ª–∏–≤<br>
3Ô∏è‚É£ –°–Ω–æ–≤–∞ <b>—Ä—É—á–Ω–æ–π</b> ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ<br>
–ò —Ç–∞–∫ –ø–æ –∫—Ä—É–≥—É. –ü–æ—Å–ª–µ —Ä—É—á–Ω–æ–≥–æ –ø–æ–ª–∏–≤–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.
</div>
</div>
<div class="neon-divider-1"></div>
<div id="watering-status" style="text-align:center;margin-bottom:15px;display:none;">
<span id="watering-status-text" style="color:#ff9aa0;font-size:14px;">‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–π –ø–æ–ª–∏–≤</span>
</div>
<div style="text-align:center;margin-top:10px">
<button class="neon-buttom icon" id="btn_watered" style="background:#1a5a1a" disabled>üíß –ü–æ–ª–∏–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω</button>
</div>
<div class="neon-divider-1"></div>
</section>
<a class="neon-buttom icon" href="index.html">–í—ã–π—Ç–∏<div class="icon_btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#fff"><path d="M21 11H6.414l5.293-5.293-1.414-1.414L2.586 12l7.707 7.707 1.414-1.414L6.414 13H21z"/></svg></div></a>
</main>
<script>
// –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ: —Ä–∞–Ω—å—à–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏ app.js –æ–±–∞ –ø–∏—Å–∞–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ.
// –¢–µ–ø–µ—Ä—å –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø—Ä–æ—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π span.
function updateSliderValue(sl){
  const container = sl.closest('.slider-container');
  if(!container) return;
  const span = container.querySelector('.slider-value');
  if(!span) return;
  const alwaysId = sl.getAttribute('data-always-id');
  const checkbox = alwaysId ? document.getElementById(alwaysId) : null;
  const isAlways = checkbox ? checkbox.checked : false;
  span.textContent = isAlways ? '-' : sl.value;
  sl.classList.toggle('locked', isAlways);
  sl.tabIndex = isAlways ? -1 : 0;
}
document.addEventListener('DOMContentLoaded', function(){
  document.querySelectorAll('.slider').forEach(function(sl){
    sl.addEventListener('input', function(){ updateSliderValue(this); });
    updateSliderValue(sl);
  });
  document.querySelectorAll('.toggle-option input[type="checkbox"]').forEach(function(cb){
    const sliderId = cb.getAttribute('data-slider');
    const slider = sliderId ? document.getElementById(sliderId) : null;
    cb.addEventListener('change', function(){
      if(slider) updateSliderValue(slider);
      if(window.ghPublish){
        const key = cb.id === 'chk_vent_day_always' ? 'vent_day_always' : 'vent_night_always';
        window.ghPublish(key, cb.checked ? 1 : 0);
      }
    });
    if(slider) updateSliderValue(slider);
  });
  // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–Ω–µ–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  function saveDaySettings() {
    if(!window.ghPublish) return;
    
    const dayParams = [
      ['lig_type', 'inp_lig_type'],
      ['lig_hours', 'inp_lig_hours'],
      ['lig_pwm', 'inp_lig_pwm'],
      ['temp_day', 'inp_temp_day'],
      ['humgr_day', 'inp_humgr_day'],
      ['humair_day', 'inp_humair_day'],
      ['vent_day', 'inp_vent_day'],
      ['vent_day_always', 'chk_vent_day_always']
    ];
    
    dayParams.forEach(([key, id]) => {
      const el = document.getElementById(id);
      if(el) {
        const payload = el.type === 'checkbox' ? (el.checked ? 1 : 0) : el.value;
        window.ghPublish(key, payload);
      }
    });
  }
  
  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  function saveNightSettings() {
    if(!window.ghPublish) return;
    
    const nightParams = [
      ['temp_night', 'inp_temp_night'],
      ['humgr_night', 'inp_humgr_night'],
      ['humair_night', 'inp_humair_night'],
      ['vent_night', 'inp_vent_night'],
      ['vent_night_always', 'chk_vent_night_always']
    ];
    
    nightParams.forEach(([key, id]) => {
      const el = document.getElementById(id);
      if(el) {
        const payload = el.type === 'checkbox' ? (el.checked ? 1 : 0) : el.value;
        window.ghPublish(key, payload);
      }
    });
  }
  /*
  function saveVentSettings(){
    if(!window.ghPublish) return;
    const el=document.getElementById('inp_vent_interval');
    if(el) window.ghPublish('vent_interval', el.value);
  }
  */
  
  // –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–Ω–µ–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  const btnSaveDay = document.getElementById('btn_save_day');
  if(btnSaveDay){
    btnSaveDay.addEventListener('click', function(){
      saveDaySettings();
      if(window.ghShowSaved) window.ghShowSaved(this);
    });
  }
  
  // –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  const btnSaveNight = document.getElementById('btn_save_night');
  if(btnSaveNight){
    btnSaveNight.addEventListener('click', function(){
      saveNightSettings();
      if(window.ghShowSaved) window.ghShowSaved(this);
    });
  }
  
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∂–∏–º–∞ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏–≤–∞
  const chkAlternateWatering = document.getElementById('chk_alternate_watering');
  const btnWatered = document.getElementById('btn_watered');
  const wateringStatus = document.getElementById('watering-status');
  
  if(chkAlternateWatering){
    chkAlternateWatering.addEventListener('change', function(){
      if(window.ghPublish){
        window.ghPublish('alternate_watering', this.checked ? 1 : 0);
      }
      // –û–±–Ω–æ–≤–ª—è–µ–º UI
      if(btnWatered) btnWatered.disabled = !this.checked;
    });
  }
  
  if(btnWatered){
    btnWatered.addEventListener('click', function(){
      if(window.ghPublish){
        window.ghPublish('watered', '1');
        if(window.ghShowSaved) window.ghShowSaved(this);
        // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ–ª–∏–≤–∞
        if(wateringStatus) wateringStatus.style.display = 'none';
      }
    });
  }
  /*
  const btnSaveVent=document.getElementById('btn_save_vent');
  if(btnSaveVent){
    btnSaveVent.addEventListener('click', function(){
      saveVentSettings();
      if(window.ghShowSaved) window.ghShowSaved(this);
    });
  }
  */
});
</script>
<script src="mqtt-simple.js"></script>
<script src="push-notifications.js"></script>
<script src="app.js"></script>
</body>
</html>